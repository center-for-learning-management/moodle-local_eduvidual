define(["jquery","core/ajax","core/modal_factory","core/notification","core/str","core/url","local_eduvidual/main"],function(e,b,a,f,d,g,c){return{check:function(){var h=e("#eduvidual_registration_orgid").val();require(["local_eduvidual/main"],function(i){i.connect({module:"register",stage:0,orgid:h})})},request:function(){var h=e("#eduvidual_registration_orgid").val();require(["local_eduvidual/main"],function(i){i.connect({module:"register",stage:1,orgid:h})})},validate:function(j){var k=e("#eduvidual_registration_orgid").val();var i=e("#eduvidual_registration_token").val();var h=e("#eduvidual_registration_name").val();if(h.length>j){d.get_strings([{key:"registration:name:lengthexceeded:title",component:"local_eduvidual"},{key:"registration:name:lengthexceeded:text",component:"local_eduvidual",param:{chars:j}},{key:"ok",component:"core"}]).done(function(l){f.alert(l[0],l[1],l[2])}).fail(f.exception)}else{require(["local_eduvidual/main"],function(l){l.connect({module:"register",stage:2,orgid:k,token:i,name:h})})}},result:function(h){if(h.result&&h.result.status&&h.result.status=="ok"){console.log(h.result);if(h.data.stage==0){e("#local_eduvidual_registration_stage-1, #local_eduvidual_registration_stage-0-error").css({display:"none"});if(h.result.authenticated>0){e("#local_eduvidual_registration_stage-0-error").css({display:"block"})}else{e("#local_eduvidual_registration_stage-1").css({display:"block"})}e("#eduvidual_registration_name").val(h.result.name.substring(0,30));e("#eduvidual_registration_mail").html(h.result.mail)}if(h.data.stage==1){d.get_strings([{key:"mailregister:confirmation",component:"local_eduvidual"},{key:"mailregister:confirmation:mailsent",component:"local_eduvidual"},{key:"ok",component:"core"}]).done(function(i){f.alert(i[0],i[1],i[2])}).fail(f.exception)}if(h.data.stage==2){e("#local_eduvidual_registration_stage-0").css({display:"none"});e("#local_eduvidual_registration_stage-1").css({display:"none"});e("#local_eduvidual_registration_stage-2").css({display:"block"});e("#local_eduvidual_registration_homecategory").attr("href","/course/index.php?categoryid="+h.result.categoryid).html(h.result.name)}}else{if(h.result.error&&h.result.error!=""){f.alert("Error",h.result.error,"ok")}else{if(h.result.status!="silent"){f.alert("Error","Action failed!","ok")}}}},}});