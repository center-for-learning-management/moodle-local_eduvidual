define(["jquery"],function(a){return{prepared:!1,post:function(b){if(console.log("jquery-ba-postmessage/post(message)",b),"undefined"!=typeof top.postMessage)top.postMessage(b,"*");else{console.log("Falling back to default behaviour of jquery.ba-postmessage"),this.prepared||this.prepare();var c=localStorage.getItem("block_eduvidual_referer");console.log("posting",b,"using origin",c),a.postMessage(b,c,parent)}},prepare:function(){this.prepared=!0;var b=a;!function(a){"$:nomunge";var b,c,d,e,f=1,g=this,h=!1,i="postMessage",j="addEventListener",k=g[i]&&!navigator.userAgent.indexOf("Opera");a[i]=function(b,c,d){c&&(b="string"==typeof b?b:a.param(b),d=d||parent,k?d[i](b,c.replace(/([^:]+:\/\/[^\/]+).*/,"$1")):c&&(d.location=c.replace(/#.*$/,"")+"#"+ +new Date+f++ +"&"+b))},a.receiveMessage=e=function(f,i,l){k?(f&&(d&&e(),d=function(b){return"string"==typeof i&&b.origin!==i||a.isFunction(i)&&i(b.origin)===h?h:void f(b)}),g[j]?g[f?j:"removeEventListener"]("message",d,h):g[f?"attachEvent":"detachEvent"]("onmessage",d)):(b&&clearInterval(b),b=null,f&&(l="number"==typeof i?i:"number"==typeof l?l:100,b=setInterval(function(){var a=document.location.hash,b=/^#?\d+&/;a!==c&&b.test(a)&&(c=a,f({data:a.replace(b,"")}))},l)))}}(b)}}});