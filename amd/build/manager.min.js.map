{"version":3,"file":"manager.min.js","sources":["../src/manager.js"],"sourcesContent":["/* eslint-disable */\ndefine(['jquery', 'core/ajax', 'core/modal_events', 'core/modal_factory', 'core/notification', 'core/str', 'core/url', 'local_eduvidual/main', 'local_eduvidual/user', 'local_eduvidual/widgets'], function ($, AJAX, ModalEvents, ModalFactory, NOTIFICATION, STR, URL, MAIN, USER, WIDGETS) {\n  return {\n    addParentFilterRequest: 0,\n    customcsscache: '',\n    debug: 1,\n    sync_queue_create: [],\n\n    addParentFilter: function (type, inp) {\n      console.log('local_eduvidual/main:addParentFilter(type, inp)', type, inp);\n      this.addParentFilterRequest++\n      var orgid = $('#local_eduvidual_manage_addparent_studentfilter').attr('data-orgid');\n      var studentid = 0;\n\n      var select = $('#local_eduvidual_manage_addparent_' + type);\n      $(select).empty();\n\n      if ($(inp).val().length == 0) {\n        $(inp).val('*');\n      }\n      studentid = $('#local_eduvidual_manage_addparent_student').val();\n\n      var addParentFilterRequest = this.addParentFilterRequest;\n\n      require(['local_eduvidual/main'], function (MAIN) {\n        MAIN.connect({module: 'manage', act: 'addparent_filter', orgid: orgid, filter: $(inp).val(), studentid: studentid}, {signalItem: inp, appendItem: select, type: type, request: addParentFilterRequest});\n      });\n    },\n    addParentSelectStudent: function () {\n      this.addParentFilter('parent', $('#local_eduvidual_manage_addparent_parentfilter'));\n    },\n    addParent: function (inp) {\n      var orgid = $('#local_eduvidual_manage_addparent_studentfilter').attr('data-orgid');\n      var studentid = $('#local_eduvidual_manage_addparent_student').val();\n      var parentid = $('#local_eduvidual_manage_addparent_parent').val();\n      if (studentid > 0 && parentid > 0) {\n        require(['local_eduvidual/main'], function (MAIN) {\n          MAIN.connect({module: 'manage', act: 'addparent', orgid: orgid, studentid: studentid, parentid: parentid}, {signalItem: inp});\n        });\n      }\n    },\n    addUser: function (secret) {\n      if (typeof secret === 'undefined') {\n        secret = $('#local_eduvidual_manage_adduser').val();\n      }\n      var role = $('#local_eduvidual_manage_adduser_role').val();\n      var orgid = $('#local_eduvidual_manage_adduser').attr('data-orgid');\n      require(['local_eduvidual/main'], function (MAIN) {\n        MAIN.connect({module: 'manage', act: 'adduser', orgid: orgid, role: role, secret: secret}, {signalItem: $('#local_eduvidual_manage_adduser')});\n      });\n    },\n    addUserAnonymous: function () {\n      var orgid = +$('#local_eduvidual_manage_createuseranonymous_orgid').val();\n      var role = $('#local_eduvidual_manage_createuseranonymous_role').val();\n      var amount = +$('#local_eduvidual_manage_createuseranonymous_amount').val();\n      var cohorts = $('#local_eduvidual_manage_createuseranonymous_cohorts').val();\n      var maximum = 50;\n      if (amount > maximum) {\n        STR.get_strings([\n          {'key': 'manage:createuseranonymous:exceededmax:title', component: 'local_eduvidual'},\n          {'key': 'manage:createuseranonymous:exceededmax:text', component: 'local_eduvidual', param: {'maximum': maximum}},\n        ]).done(function (s) {\n            NOTIFICATION.alert(s[0], s[1]);\n          }\n        ).fail(NOTIFICATION.exception);\n      } else {\n        require(['local_eduvidual/main'], function (MAIN) {\n          MAIN.connect({module: 'manage', act: 'adduser_anonymous', orgid: orgid, role: role, amount: amount, cohorts: cohorts}, {signalItem: $('#local_eduvidual_manage_adduseranonymous_btn')});\n        });\n      }\n    },\n    categoryAdd: function (src, orgid, parentid) {\n      if (typeof src !== 'undefined') {\n        var li = $(src);\n        while (!$(li).is('li')) {\n          li = $(li).parent();\n        }\n      }\n      if (typeof orgid === 'undefined') {\n        orgid = +$('.ul-eduvidual-courses').attr('data-orgid');\n      }\n      if (typeof parentid === 'undefined') {\n        parentid = +li.attr('data-categoryid');\n      }\n      var runnable = {\n        orgid: orgid,\n        li: li,\n        parentid: parentid,\n        run: function (name) {\n          var o = this;\n          if (name !== null && name.length > 2) {\n            require(['local_eduvidual/main'], function (MAIN) {\n              MAIN.connect({module: 'manage', act: 'addcategory', orgid: o.orgid, parentid: o.parentid, name: name}, {parent: o.li});\n            });\n          } else if (name !== null) {\n            STR.get_strings([\n              {'key': 'categoryadd:title:length:title', component: 'local_eduvidual'},\n              {'key': 'categoryadd:title:length:text', component: 'local_eduvidual'},\n            ]).done(function (s) {\n                NOTIFICATION.alert(s[0], s[1]);\n              }\n            ).fail(NOTIFICATION.exception);\n          }\n        },\n      }\n      console.log(runnable);\n      var prompt = WIDGETS.prompt();\n      STR.get_strings([\n        {'key': 'categoryadd:title', component: 'local_eduvidual'},\n        {'key': 'categoryadd:text', component: 'local_eduvidual'},\n      ]).done(function (s) {\n          prompt.create(s[0], s[1], '', runnable);\n        }\n      ).fail(NOTIFICATION.exception);\n    },\n    categoryEdit: function (src, orgid, parentid, currentname) {\n      if (typeof src !== 'undefined') {\n        var li = $(src);\n        while (!$(li).is('li')) {\n          li = $(li).parent();\n        }\n      }\n      if (typeof orgid === 'undefined') {\n        orgid = +$('.ul-eduvidual-courses').attr('data-orgid');\n      }\n      if (typeof parentid === 'undefined') {\n        parentid = +li.attr('data-categoryid');\n      }\n      if (typeof currentname === 'undefined') {\n        currentname = '';\n      }\n      var runnable = {\n        orgid: orgid,\n        li: li,\n        parentid: parentid,\n        run: function (name) {\n          var o = this;\n          if (name !== null && name.length > 2) {\n            require(['local_eduvidual/main'], function (MAIN) {\n              MAIN.connect({module: 'manage', act: 'editcategory', orgid: o.orgid, parentid: o.parentid, name: name}, {parent: o.li});\n            });\n          } else if (name !== null) {\n            STR.get_strings([\n              {'key': 'categoryedit:title:length:title', component: 'local_eduvidual'},\n              {'key': 'categoryedit:title:length:text', component: 'local_eduvidual'},\n            ]).done(function (s) {\n                NOTIFICATION.alert(s[0], s[1]);\n              }\n            ).fail(NOTIFICATION.exception);\n          }\n        },\n      }\n      console.log(runnable);\n      var prompt = WIDGETS.prompt();\n      STR.get_strings([\n        {'key': 'categoryadd:title', component: 'local_eduvidual'},\n        {'key': 'categoryadd:text', component: 'local_eduvidual'},\n      ]).done(function (s) {\n          prompt.create(s[0], s[1], currentname, runnable);\n        }\n      ).fail(NOTIFICATION.exception);\n    },\n    categoryRemove: function (src, confirm, orgid, parentid) {\n      if (typeof confirm === 'undefined' || !confirm) {\n        var MANAGER = this;\n        STR.get_strings([\n          {'key': 'categoryremove:title', component: 'local_eduvidual'},\n          {'key': 'categoryremove:text', component: 'local_eduvidual'},\n          {'key': 'yes'},\n          {'key': 'no'}\n        ]).done(function (s) {\n            NOTIFICATION.confirm(s[0], s[1], s[2], s[3], function () {\n              MANAGER.categoryRemove(src, true, orgid, parentid)\n            });\n          }\n        ).fail(NOTIFICATION.exception);\n      } else {\n        if (typeof orgid === 'undefined') {\n          orgid = +$('.ul-eduvidual-courses').attr('data-orgid');\n        }\n        if (typeof parentid === 'undefined') {\n          var li = $(src);\n          while (!$(li).is('li')) {\n            li = $(li).parent();\n          }\n          parentid = +li.attr('data-categoryid');\n        }\n        require(['local_eduvidual/main'], function (MAIN) {\n          MAIN.connect({module: 'manage', act: 'removecategory', orgid: orgid, parentid: parentid}, {parent: li});\n        });\n      }\n    },\n    createAccesscode: function () {\n      var code = $('#local_eduvidual_manage_accesscode_code').val();\n      var orgid = +$('#local_eduvidual_manage_adduser').attr('data-orgid');\n      var maturity = $('#local_eduvidual_manage_accesscode_maturity').val();\n      var role = $('#local_eduvidual_manage_accesscode_role').val();\n      require(['local_eduvidual/main'], function (MAIN) {\n        MAIN.connect({module: 'manage', act: 'accesscode_create', orgid: orgid, code: code, role: role, maturity: maturity}, {signalItem: $('#local_eduvidual_manage_accesscode_btn')});\n      });\n    },\n    /**\n     * Create user accounts.\n     * @param uniqid of the controls.\n     * @param item only execute particular item, if empty, execute all.\n     */\n    createUsers: function (uniqid, item) {\n      if (this.debug > 0) console.log('local_eduvidual/manager::createUsers(uniqid, item)', uniqid, item);\n      var MAIN = this;\n      if (!item) {\n        $('.import-btn-' + uniqid).addClass('disabled');\n\n        $('.' + uniqid + ' tr.user').each(function () {\n          var tr = this;\n          var import_data = $(tr).data('import_data');\n\n          MAIN.sync_queue_create.push({'uniqid': uniqid, 'item': {import_data, tr}});\n        });\n        if (MAIN.sync_queue_create.length > 0) {\n          var queueitem = MAIN.sync_queue_create.shift();\n          MAIN.createUsers(queueitem.uniqid, queueitem.item);\n        }\n      } else {\n        var tr = item.tr;\n        var import_data = item.import_data;\n        $(tr).css('filter', 'blur(2px)');\n        console.debug(item);\n\n        AJAX.call([{\n          methodname: 'local_eduvidual_manager_create_users',\n          args: import_data,\n          done: function (result) {\n            $(tr).css('filter', 'unset');\n            if (MAIN.debug > 0) {\n              console.log('=> Result for ' + uniqid, result);\n            }\n            if (result.status == 1) {\n              //$(tr).css('background-color', 'rgba(0,255,0,0.1)');\n              $(tr).find('.process-indicator').attr('src', '/pix/i/completion-auto-pass.svg');\n            }\n            if (result.status == 0) {\n              //$(tr).css('background-color', '');\n              $(tr).find('.process-indicator').attr('src', '/pix/i/completion-auto-y.svg');\n            }\n            if (result.status == -1) {\n              $(tr).css('background-color', 'rgba(255,0,0,0.1)');\n              $(tr).find('.process-indicator').attr('src', '/pix/i/completion-auto-fail.svg');\n            }\n            if (result.message.length > 0) {\n              $(tr).find('.action').html(result.message);\n            }\n            if (MAIN.sync_queue_create.length > 0) {\n              var queueitem = MAIN.sync_queue_create.shift();\n              MAIN.createUsers(queueitem.uniqid, queueitem.item);\n            } else {\n              $('.import-btn-' + uniqid).removeClass('disabled');\n            }\n          },\n          fail: Notification.exception\n        }]);\n      }\n    },\n    customcss: function () {\n      var orgid = $('#local_eduvidual_manage_customcss').attr('data-orgid');\n      require(['local_eduvidual/main'], function (MAIN) {\n        MAIN.watchValue({\n          target: '#local_eduvidual_manage_customcss',\n          orgid: orgid,\n          run: function () {\n            MAIN.connect({module: 'manage', act: 'customcss', orgid: this.orgid, customcss: $(this.target).val()}, {signalItem: $(this.target)});\n          }\n        });\n      });\n    },\n    editProfile: function (orgid, userid, callback) {\n      STR.get_strings([\n        {'key': 'profile', component: 'core'},\n      ]).done(function (s) {\n          var method = 'local_eduvidual_manager_user_form';\n          var data = {orgid: orgid, userid: userid};\n          //console.log('Sending to ', method, data);\n          //MAIN.spinnerGrid(true);\n          AJAX.call([{\n            methodname: method,\n            args: data,\n            done: function (formhtml) {\n              //console.log(formhtml);\n              ModalFactory.create({\n                type: ModalFactory.types.SAVE_CANCEL,\n                title: s[0],\n                body: formhtml,\n              }).then(function (modal) {\n                var root = modal.getRoot();\n                //console.log(root, ModalEvents);\n                root.on(ModalEvents.save, function (e) {\n                  e.preventDefault();\n                  var method = 'local_eduvidual_manager_user_update';\n                  var data = {\n                    'orgid': orgid,\n                    'userid': userid,\n                    'firstname': $(root).find('[name=\"firstname\"]').val(),\n                    'lastname': $(root).find('[name=\"lastname\"]').val(),\n                    'email': $(root).find('[name=\"email\"]').val(),\n                  };\n                  //console.log('SAVING', data);\n                  AJAX.call([{\n                    methodname: method,\n                    args: data,\n                    done: function (result) {\n                      console.log('saved', result);\n                      if (typeof result.success !== 'undefined' && result.success == 1) {\n                        modal.hide();\n                        if (typeof callback !== 'undefined' && typeof callback.run !== 'undefined') {\n                          callback.run();\n                        }\n                      }\n                      if (typeof result.message !== 'undefined') {\n                        NOTIFICATION.alert(result.subject, result.message);\n                      }\n                    },\n                    fail: NOTIFICATION.exception\n                  }]);\n                });\n                //MAIN.spinnerGrid(false);\n                modal.show();\n              });\n            },\n            fail: NOTIFICATION.exception\n          }]);\n        }\n      ).fail(NOTIFICATION.exception);\n    },\n    exportUserPopup: function (orgid, userids) {\n      if (this.debug > 0) console.log('local_eduvidual/manager:exportUserPopup(orgid, userids)', orgid, userids);\n      AJAX.call([{\n        methodname: 'local_eduvidual_manager_user_exportform',\n        args: {orgid: orgid, userids: userids},\n        done: function (formhtml) {\n          ModalFactory.create({\n            title: STR.get_string('export', 'local_eduvidual'),\n            type: ModalFactory.types.SAVE_CANCEL,\n            body: formhtml,\n          }).done(function (modal) {\n            var root = modal.getRoot();\n            //console.log(root, ModalEvents);\n            root.on(ModalEvents.save, function (e) {\n              e.preventDefault();\n              modal.hide();\n              $(root).find('form').submit();\n              $(root).remove();\n            });\n            STR.get_strings([\n              {'key': 'export', component: 'local_eduvidual'},\n            ]).done(function (s) {\n              $(root).find('.modal-footer button[data-action=\"save\"]').html(s[0]);\n            });\n            $(root).find('button[type=\"submit\"]').remove();\n\n            modal.show();\n          });\n        },\n        fail: NOTIFICATION.exception\n      }]);\n    },\n    forceEnrol: function (courseid) {\n      require(['local_eduvidual/main'], function (MAIN) {\n        MAIN.connect({module: 'manage', act: 'force_enrol', courseid: courseid}, {});\n      });\n    },\n    /**\n     * Sets the maildomain to auto assign users to organizations\n     **/\n    maildomain: function (inp, orgid, type) {\n      if (this.debug > 0) console.log('MANAGER.maildomain(inp, orgid, type)', inp, orgid, type);\n\n      require(['local_eduvidual/main'], function (MAIN) {\n        MAIN.watchValue({\n          orgid: orgid,\n          target: $(inp),\n          type: type,\n          run: function () {\n            var o = this;\n            require(['local_eduvidual/main'], function (MAIN) {\n              MAIN.connect({module: 'manage', act: 'maildomain', orgid: o.orgid, type: o.type, maildomain: $(o.target).val()}, {signalItem: $(o.target)});\n            });\n          }\n        });\n      });\n    },\n    /**\n     * Searches for users matching the maildomain(s) and assigns them to the organization.\n     **/\n    maildomain_apply: function (orgid, btn) {\n      if (this.debug > 0) console.log('MANAGER.maildomain_apply(orgid, btn)', orgid, btn);\n      require(['local_eduvidual/main'], function (MAIN) {\n        MAIN.connect({module: 'manage', act: 'maildomain_apply', orgid: orgid}, {signalItem: $(btn)});\n      });\n    },\n    /**\n     * Custom org settings - override big blue button settings.\n     * @param uniqid of the form.\n     * @param signalitem that shows success / failure.\n     */\n    overrideBBB: function (uniqid, signalitem) {\n      var orgid = $('#orgid-' + uniqid).val();\n      var bbb_serverurl = $('.bbb_serverurl-' + uniqid).val();\n      var bbb_sharedsecret = $('.bbb_sharedsecret-' + uniqid).val();\n      require(['local_eduvidual/main'], function (MAIN) {\n        MAIN.connect({module: 'manage', act: 'override_bigbluebutton', orgid: orgid, bbb_serverurl: bbb_serverurl, bbb_sharedsecret: bbb_sharedsecret}, {signalItem: $(signalitem)});\n      });\n    },\n    /**\n     * Custom org settings - override role names of course roles.\n     * @param uniqid of the form.\n     * @param signalitem that shows success / failure.\n     */\n    overrideRolenames: function (uniqid, signalitem) {\n      var orgid = $('#orgid-' + uniqid).val();\n      var roles = [];\n      $('.overriderole-' + uniqid).each(function () {\n        roles[roles.length] = {\n          roleid: $(this).attr('data-roleid'),\n          override: $(this).val()\n        };\n      });\n      require(['local_eduvidual/main'], function (MAIN) {\n        MAIN.connect({module: 'manage', act: 'override_rolenames', orgid: orgid, roles: JSON.stringify(roles)}, {signalItem: $(signalitem)});\n      });\n    },\n    /**\n     * Reset the password of users.\n     */\n    setpwforcechange: function () {\n      var orgid = $('#local_eduvidual_manage_adduser').attr('data-orgid');\n      var role = $('#local_eduvidual_manage_setuserrole_role').val();\n      var secrets = [];\n      $('#local_eduvidual_manage_setuserrole_user option:selected:not([value=\"\"])').each(function () {\n        secrets.push($(this).val());\n      });\n      if (secrets.length == 0) return;\n      require(['local_eduvidual/main'], function (MAIN) {\n        MAIN.connect({module: 'manage', act: 'setpwforcechange', orgid: orgid, secrets: secrets}, {signalItem: $('#local_eduvidual_manage_setuserforcechange')});\n      });\n    },\n    /**\n     * Reset the password of users.\n     */\n    setpwreset: function () {\n      var orgid = $('#local_eduvidual_manage_adduser').attr('data-orgid');\n      var role = $('#local_eduvidual_manage_setuserrole_role').val();\n      var secrets = [];\n      $('#local_eduvidual_manage_setuserrole_user option:selected:not([value=\"\"])').each(function () {\n        secrets.push($(this).val());\n      });\n      if (secrets.length == 0) return;\n      require(['local_eduvidual/main'], function (MAIN) {\n        MAIN.connect({module: 'manage', act: 'setpwreset', orgid: orgid, secrets: secrets}, {signalItem: $('#local_eduvidual_manage_setuserrole')});\n      });\n    },\n    setuserrole: function () {\n      var orgid = $('#local_eduvidual_manage_adduser').attr('data-orgid');\n      var role = $('#local_eduvidual_manage_setuserrole_role').val();\n      var secrets = [];\n      $('#local_eduvidual_manage_setuserrole_user option:selected:not([value=\"\"])').each(function () {\n        secrets.push($(this).val());\n      });\n      //var secret = $('#local_eduvidual_manage_setuserrole').val();\n      if (secrets.length == 0) return;\n      require(['local_eduvidual/main'], function (MAIN) {\n        MAIN.connect({module: 'manage', act: 'setuserrole', orgid: orgid, role: role, secrets: secrets}, {signalItem: $('#local_eduvidual_manage_setuserrole')});\n      });\n    },\n    setuserrole_search: function (marksuccess, markfailed) {\n      var orgid = $('#local_eduvidual_manage_adduser').attr('data-orgid');\n      var search = $('#local_eduvidual_manage_setuserrole_search').val();\n      if (search.length < 2) {\n        return;\n      } else {\n        require(['local_eduvidual/main'], function (MAIN) {\n          MAIN.connect({module: 'manage', act: 'setuserrole_search', orgid: orgid, search: search}, {marksuccess: marksuccess, markfailed: markfailed});\n        });\n      }\n    },\n    result: function (o) {\n      if (o.data.act == 'accesscode_create') {\n        if (o.result.status == 'ok') {\n          top.location.href = URL.relativeUrl('/local/eduvidual/pages/manage.php', {orgid: o.data.orgid, act: 'users', tab: 'accesscodes'});\n        }\n      }\n      if (o.data.act == 'accesscode_revoke') {\n        if (o.result.status == 'ok') {\n          top.location.href = URL.relativeUrl('/local/eduvidual/pages/manage.php', {orgid: o.data.orgid, act: 'users', tab: 'accesscodes'});\n        }\n      }\n      if (o.data.act == 'addcategory') {\n        require(['local_eduvidual/main'], function (MAIN) {\n          MAIN.confirmed('.ul-eduvidual-courses li[data-categoryid=\"' + o.data.parentid + '\"]', (o.result.status == 'ok'));\n        });\n        if (o.result.status == 'ok') {\n          if (typeof o.payload.parent === 'undefined') {\n            // Called by myorgs.php and update AJAX\n            require(['local_eduvidual/user'], function (USER) {\n              USER.loadCategory(o.data.parentid, o.data.orgid);\n            });\n          } else {\n            // Called by manage.php and updates tree\n            top.location.href = top.location.href;\n          }\n        }\n      }\n      if (o.data.act == 'addparent') {\n        this.addParentSelectStudent();\n      }\n      if (o.data.act == 'addparent_filter') {\n        if (o.payload.request != this.addParentFilterRequest) {\n          // There has been another request in the meanwhile, drop the results!\n          return;\n        }\n        $(o.payload.appendItem).empty();\n        var keys = Object.keys(o.result.users);\n        if (keys.length > 0) {\n          for (var a = 0; a < keys.length; a++) {\n            var u = o.result.users[keys[a]];\n            var state = '';\n            if (o.payload.type == 'parent') {\n              if (typeof u.isparent !== 'undefined' && u.isparent) {\n                state = '+ ';\n              } else {\n                state = '- ';\n              }\n            }\n            $(o.payload.appendItem).append($('<option>').html(state + u.userfullname + ' (' + u.email + ')').attr('value', u.id));\n          }\n        }\n      }\n      if (o.data.act == 'adduser' || o.data.act == 'setuserrole') {\n        if (o.result.status == 'ok') {\n          $('#local_eduvidual_manage_' + o.data.act).val('ok');\n          setTimeout(function () {\n            $('#local_eduvidual_manage_' + o.data.act).val('');\n          }, 500);\n        }\n        this.setuserrole_search();\n      }\n      if (o.data.act == 'adduser_anonymous') {\n        $('#local_eduvidual_manage_createuseranonymous_success span').html(o.result.success);\n        $('#local_eduvidual_manage_createuseranonymous_failed span').html(o.result.failed);\n        $('#local_eduvidual_manage_createuseranonymous_success').css('display', (o.result.success > 0) ? 'block' : 'none');\n        $('#local_eduvidual_manage_createuseranonymous_failed').css('display', (o.result.failed > 0) ? 'block' : 'none');\n        $('#local_eduvidual_manage_createuseranonymous_success input').attr('data-bunch', o.data.bunch);\n      }\n      if (o.data.act == 'customcss') {\n        $('#local_eduvidual_style_org').html(o.data.customcss);\n      }\n      if (o.data.act == 'force_enrol') {\n        if (o.result.status == 'ok') {\n          top.location.href = URL.fileUrl(\"/course/view.php\", \"\") + '?id=' + o.data.courseid;\n        }\n      }\n      if (o.data.act == 'maildomain_apply') {\n        if (typeof o.result.updated !== 'undefined') {\n          alert('Updated ' + o.result.updated.Teacher + ' Teachers and ' + o.result.updated.Student + ' Students');\n        }\n      }\n      if (o.data.act == 'removecategory' || o.data.act == 'editcategory') {\n        require(['local_eduvidual/main'], function (MAIN) {\n          MAIN.confirmed('.ul-eduvidual-courses li[data-categoryid=\"' + o.data.parentid + '\"]', (o.result.status == 'ok'));\n        });\n        if (o.result.status == 'ok') {\n          if (typeof o.payload.parent === 'undefined') {\n            // Called by myorgs.php and update AJAX\n            require(['local_eduvidual/user'], function (USER) {\n              USER.loadCategory((typeof o.result.removedcat !== 'undefined') ? o.result.removedcat.parent : o.result.editedcat.id, o.data.orgid);\n            });\n          } else if (o.data.act == 'removecategory') {\n            // Called by manage.php and updates tree\n            setTimeout(function () {\n              $('.ul-eduvidual-courses li[data-categoryid=\"' + o.data.parentid + '\"]').remove();\n            }, 500);\n          } else if (o.data.act == 'editcategory') {\n            $('.ul-eduvidual-courses li[data-categoryid=\"' + o.data.parentid + '\"]>label>span').html(o.data.name);\n          }\n        }\n      }\n      console.log(o);\n      if (o.data.act == 'setpwreset') {\n        STR.get_strings([\n          {'key': 'manage:users:setpwreset', component: 'local_eduvidual'},\n        ]).done(function (s) {\n            require(['core/modal_factory', 'core/templates'], function (ModalFactory, Templates) {\n              ModalFactory.create({\n                title: s[0],\n                body: Templates.render('local_eduvidual/manage_setpwreset_modal', {failed: o.result.failed.join(', '), hasfailed: o.result.failed.length, hasupdated: o.result.updated.length, updated: o.result.updated.join(', ')}),\n                footer: '',\n              }).done(function (modal) {\n                // Do what you want with your modal.\n                modal.show();\n              });\n            });\n          }\n        ).fail(NOTIFICATION.exception);\n      }\n      if (o.data.act == 'setuserrole_search') {\n        if (typeof o.result.users !== 'undefined') {\n          $('#local_eduvidual_manage_setuserrole_user option:not([value=\"\"])').remove();\n          for (var a = 0; a < o.result.users.length; a++) {\n            var s = $('<option>').attr('value', o.result.users[a].secret).html(o.result.users[a].userfullname + ((o.result.users[a].email != '') ? ' (' + o.result.users[a].email + ')' : ''));\n            $('#local_eduvidual_manage_setuserrole_user').append(s);\n          }\n          var updated = o.payload.marksuccess;\n          if (typeof updated !== 'undefined' && updated.length > 0) {\n            require(['local_eduvidual/main'], function (MAIN) {\n              for (var a = 0; a < updated.length; a++) {\n                MAIN.signal({signalItem: $('#local_eduvidual_manage_setuserrole_user option[value=\"' + updated[a] + '\"]')}, undefined, 'success');\n              }\n            });\n          }\n          var failed = o.payload.markfailed;\n          if (typeof failed !== 'undefined' && failed.length > 0) {\n            for (var a = 0; a < failed.length; a++) {\n              require(['local_eduvidual/main'], function (MAIN) {\n                MAIN.signal({signalItem: $('#local_eduvidual_manage_setuserrole_user option[value=\"' + failed[a] + '\"]')}, undefined, 'success');\n              });\n            }\n          }\n        }\n      }\n    },\n    revokeAccesscode: function (id) {\n      var orgid = +$('#local_eduvidual_manage_adduser').attr('data-orgid');\n      require(['local_eduvidual/main'], function (MAIN) {\n        MAIN.connect({module: 'manage', act: 'accesscode_revoke', orgid: orgid, id: id}, {});\n      });\n    },\n  };\n});\n"],"names":["define","$","AJAX","ModalEvents","ModalFactory","NOTIFICATION","STR","URL","MAIN","USER","WIDGETS","addParentFilterRequest","customcsscache","debug","sync_queue_create","addParentFilter","type","inp","console","log","studentid","orgid","attr","select","empty","val","length","this","require","connect","module","act","filter","signalItem","appendItem","request","addParentSelectStudent","addParent","parentid","addUser","secret","role","addUserAnonymous","amount","cohorts","get_strings","component","param","done","s","alert","fail","exception","categoryAdd","src","li","is","parent","runnable","run","name","o","prompt","create","categoryEdit","currentname","categoryRemove","confirm","MANAGER","createAccesscode","code","maturity","createUsers","uniqid","item","tr","import_data","css","call","methodname","args","result","status","find","message","html","queueitem","shift","removeClass","Notification","addClass","each","data","push","customcss","watchValue","target","editProfile","userid","callback","formhtml","types","SAVE_CANCEL","title","body","then","modal","root","getRoot","on","save","e","preventDefault","success","hide","subject","show","exportUserPopup","userids","get_string","submit","remove","forceEnrol","courseid","maildomain","maildomain_apply","btn","overrideBBB","signalitem","bbb_serverurl","bbb_sharedsecret","overrideRolenames","roles","roleid","override","JSON","stringify","setpwforcechange","secrets","setpwreset","setuserrole","setuserrole_search","marksuccess","markfailed","search","top","location","href","relativeUrl","tab","confirmed","payload","loadCategory","keys","Object","users","a","u","state","isparent","append","userfullname","email","id","setTimeout","failed","bunch","fileUrl","updated","Teacher","Student","removedcat","editedcat","Templates","render","join","hasfailed","hasupdated","footer","signal","undefined","revokeAccesscode"],"mappings":"AACAA,iCAAO,CAAC,SAAU,YAAa,oBAAqB,qBAAsB,oBAAqB,WAAY,WAAY,uBAAwB,uBAAwB,4BAA4B,SAAUC,EAAGC,KAAMC,YAAaC,aAAcC,aAAcC,IAAKC,IAAKC,KAAMC,KAAMC,eAC5Q,CACLC,uBAAwB,EACxBC,eAAgB,GAChBC,MAAO,EACPC,kBAAmB,GAEnBC,gBAAiB,SAAUC,KAAMC,KAC/BC,QAAQC,IAAI,kDAAmDH,KAAMC,UAChEN,6BAEDS,UADAC,MAAQpB,EAAE,mDAAmDqB,KAAK,cAGlEC,OAAStB,EAAE,qCAAuCe,MACtDf,EAAEsB,QAAQC,QAEiB,GAAvBvB,EAAEgB,KAAKQ,MAAMC,QACfzB,EAAEgB,KAAKQ,IAAI,KAEbL,UAAYnB,EAAE,6CAA6CwB,UAEvDd,uBAAyBgB,KAAKhB,uBAElCiB,QAAQ,CAAC,yBAAyB,SAAUpB,MAC1CA,KAAKqB,QAAQ,CAACC,OAAQ,SAAUC,IAAK,mBAAoBV,MAAOA,MAAOW,OAAQ/B,EAAEgB,KAAKQ,MAAOL,UAAWA,WAAY,CAACa,WAAYhB,IAAKiB,WAAYX,OAAQP,KAAMA,KAAMmB,QAASxB,6BAGnLyB,uBAAwB,gBACjBrB,gBAAgB,SAAUd,EAAE,oDAEnCoC,UAAW,SAAUpB,SACfI,MAAQpB,EAAE,mDAAmDqB,KAAK,cAClEF,UAAYnB,EAAE,6CAA6CwB,MAC3Da,SAAWrC,EAAE,4CAA4CwB,MACzDL,UAAY,GAAKkB,SAAW,GAC9BV,QAAQ,CAAC,yBAAyB,SAAUpB,MAC1CA,KAAKqB,QAAQ,CAACC,OAAQ,SAAUC,IAAK,YAAaV,MAAOA,MAAOD,UAAWA,UAAWkB,SAAUA,UAAW,CAACL,WAAYhB,UAI9HsB,QAAS,SAAUC,aACK,IAAXA,SACTA,OAASvC,EAAE,mCAAmCwB,WAE5CgB,KAAOxC,EAAE,wCAAwCwB,MACjDJ,MAAQpB,EAAE,mCAAmCqB,KAAK,cACtDM,QAAQ,CAAC,yBAAyB,SAAUpB,MAC1CA,KAAKqB,QAAQ,CAACC,OAAQ,SAAUC,IAAK,UAAWV,MAAOA,MAAOoB,KAAMA,KAAMD,OAAQA,QAAS,CAACP,WAAYhC,EAAE,yCAG9GyC,iBAAkB,eACZrB,OAASpB,EAAE,qDAAqDwB,MAChEgB,KAAOxC,EAAE,oDAAoDwB,MAC7DkB,QAAU1C,EAAE,sDAAsDwB,MAClEmB,QAAU3C,EAAE,uDAAuDwB,MAEnEkB,OADU,GAEZrC,IAAIuC,YAAY,CACd,KAAQ,+CAAgDC,UAAW,mBACnE,KAAQ,8CAA+CA,UAAW,kBAAmBC,MAAO,SAJlF,OAKTC,MAAK,SAAUC,GACd5C,aAAa6C,MAAMD,EAAE,GAAIA,EAAE,OAE7BE,KAAK9C,aAAa+C,WAEpBxB,QAAQ,CAAC,yBAAyB,SAAUpB,MAC1CA,KAAKqB,QAAQ,CAACC,OAAQ,SAAUC,IAAK,oBAAqBV,MAAOA,MAAOoB,KAAMA,KAAME,OAAQA,OAAQC,QAASA,SAAU,CAACX,WAAYhC,EAAE,sDAI5IoD,YAAa,SAAUC,IAAKjC,MAAOiB,kBACd,IAARgB,YACLC,GAAKtD,EAAEqD,MACHrD,EAAEsD,IAAIC,GAAG,OACfD,GAAKtD,EAAEsD,IAAIE,cAGM,IAAVpC,QACTA,OAASpB,EAAE,yBAAyBqB,KAAK,oBAEnB,IAAbgB,WACTA,UAAYiB,GAAGjC,KAAK,wBAElBoC,SAAW,CACbrC,MAAOA,MACPkC,GAAIA,GACJjB,SAAUA,SACVqB,IAAK,SAAUC,UACTC,EAAIlC,KACK,OAATiC,MAAiBA,KAAKlC,OAAS,EACjCE,QAAQ,CAAC,yBAAyB,SAAUpB,MAC1CA,KAAKqB,QAAQ,CAACC,OAAQ,SAAUC,IAAK,cAAeV,MAAOwC,EAAExC,MAAOiB,SAAUuB,EAAEvB,SAAUsB,KAAMA,MAAO,CAACH,OAAQI,EAAEN,QAElG,OAATK,MACTtD,IAAIuC,YAAY,CACd,KAAQ,iCAAkCC,UAAW,mBACrD,KAAQ,gCAAiCA,UAAW,qBACnDE,MAAK,SAAUC,GACd5C,aAAa6C,MAAMD,EAAE,GAAIA,EAAE,OAE7BE,KAAK9C,aAAa+C,aAI1BlC,QAAQC,IAAIuC,cACRI,OAASpD,QAAQoD,SACrBxD,IAAIuC,YAAY,CACd,KAAQ,oBAAqBC,UAAW,mBACxC,KAAQ,mBAAoBA,UAAW,qBACtCE,MAAK,SAAUC,GACda,OAAOC,OAAOd,EAAE,GAAIA,EAAE,GAAI,GAAIS,aAEhCP,KAAK9C,aAAa+C,YAEtBY,aAAc,SAAUV,IAAKjC,MAAOiB,SAAU2B,qBACzB,IAARX,YACLC,GAAKtD,EAAEqD,MACHrD,EAAEsD,IAAIC,GAAG,OACfD,GAAKtD,EAAEsD,IAAIE,cAGM,IAAVpC,QACTA,OAASpB,EAAE,yBAAyBqB,KAAK,oBAEnB,IAAbgB,WACTA,UAAYiB,GAAGjC,KAAK,yBAEK,IAAhB2C,cACTA,YAAc,QAEZP,SAAW,CACbrC,MAAOA,MACPkC,GAAIA,GACJjB,SAAUA,SACVqB,IAAK,SAAUC,UACTC,EAAIlC,KACK,OAATiC,MAAiBA,KAAKlC,OAAS,EACjCE,QAAQ,CAAC,yBAAyB,SAAUpB,MAC1CA,KAAKqB,QAAQ,CAACC,OAAQ,SAAUC,IAAK,eAAgBV,MAAOwC,EAAExC,MAAOiB,SAAUuB,EAAEvB,SAAUsB,KAAMA,MAAO,CAACH,OAAQI,EAAEN,QAEnG,OAATK,MACTtD,IAAIuC,YAAY,CACd,KAAQ,kCAAmCC,UAAW,mBACtD,KAAQ,iCAAkCA,UAAW,qBACpDE,MAAK,SAAUC,GACd5C,aAAa6C,MAAMD,EAAE,GAAIA,EAAE,OAE7BE,KAAK9C,aAAa+C,aAI1BlC,QAAQC,IAAIuC,cACRI,OAASpD,QAAQoD,SACrBxD,IAAIuC,YAAY,CACd,KAAQ,oBAAqBC,UAAW,mBACxC,KAAQ,mBAAoBA,UAAW,qBACtCE,MAAK,SAAUC,GACda,OAAOC,OAAOd,EAAE,GAAIA,EAAE,GAAIgB,YAAaP,aAEzCP,KAAK9C,aAAa+C,YAEtBc,eAAgB,SAAUZ,IAAKa,QAAS9C,MAAOiB,kBACtB,IAAZ6B,SAA4BA,QAahC,SACgB,IAAV9C,QACTA,OAASpB,EAAE,yBAAyBqB,KAAK,oBAEnB,IAAbgB,SAA0B,SAC/BiB,GAAKtD,EAAEqD,MACHrD,EAAEsD,IAAIC,GAAG,OACfD,GAAKtD,EAAEsD,IAAIE,SAEbnB,UAAYiB,GAAGjC,KAAK,mBAEtBM,QAAQ,CAAC,yBAAyB,SAAUpB,MAC1CA,KAAKqB,QAAQ,CAACC,OAAQ,SAAUC,IAAK,iBAAkBV,MAAOA,MAAOiB,SAAUA,UAAW,CAACmB,OAAQF,YAzBvD,KAC1Ca,QAAUzC,KACdrB,IAAIuC,YAAY,CACd,KAAQ,uBAAwBC,UAAW,mBAC3C,KAAQ,sBAAuBA,UAAW,mBAC1C,KAAQ,OACR,KAAQ,QACPE,MAAK,SAAUC,GACd5C,aAAa8D,QAAQlB,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAIA,EAAE,IAAI,WAC3CmB,QAAQF,eAAeZ,KAAK,EAAMjC,MAAOiB,gBAG7Ca,KAAK9C,aAAa+C,aAiBxBiB,iBAAkB,eACZC,KAAOrE,EAAE,2CAA2CwB,MACpDJ,OAASpB,EAAE,mCAAmCqB,KAAK,cACnDiD,SAAWtE,EAAE,+CAA+CwB,MAC5DgB,KAAOxC,EAAE,2CAA2CwB,MACxDG,QAAQ,CAAC,yBAAyB,SAAUpB,MAC1CA,KAAKqB,QAAQ,CAACC,OAAQ,SAAUC,IAAK,oBAAqBV,MAAOA,MAAOiD,KAAMA,KAAM7B,KAAMA,KAAM8B,SAAUA,UAAW,CAACtC,WAAYhC,EAAE,gDAQxIuE,YAAa,SAAUC,OAAQC,MACzB/C,KAAKd,MAAQ,GAAGK,QAAQC,IAAI,qDAAsDsD,OAAQC,UAC1FlE,KAAOmB,QACN+C,KAaE,KACDC,GAAKD,KAAKC,GACVC,YAAcF,KAAKE,YACvB3E,EAAE0E,IAAIE,IAAI,SAAU,aACpB3D,QAAQL,MAAM6D,MAEdxE,KAAK4E,KAAK,CAAC,CACTC,WAAY,uCACZC,KAAMJ,YACN5B,KAAM,SAAUiC,WACdhF,EAAE0E,IAAIE,IAAI,SAAU,SAChBrE,KAAKK,MAAQ,GACfK,QAAQC,IAAI,iBAAmBsD,OAAQQ,QAEpB,GAAjBA,OAAOC,QAETjF,EAAE0E,IAAIQ,KAAK,sBAAsB7D,KAAK,MAAO,mCAE1B,GAAjB2D,OAAOC,QAETjF,EAAE0E,IAAIQ,KAAK,sBAAsB7D,KAAK,MAAO,iCAEzB,GAAlB2D,OAAOC,SACTjF,EAAE0E,IAAIE,IAAI,mBAAoB,qBAC9B5E,EAAE0E,IAAIQ,KAAK,sBAAsB7D,KAAK,MAAO,oCAE3C2D,OAAOG,QAAQ1D,OAAS,GAC1BzB,EAAE0E,IAAIQ,KAAK,WAAWE,KAAKJ,OAAOG,SAEhC5E,KAAKM,kBAAkBY,OAAS,EAAG,KACjC4D,UAAY9E,KAAKM,kBAAkByE,QACvC/E,KAAKgE,YAAYc,UAAUb,OAAQa,UAAUZ,WAE7CzE,EAAE,eAAiBwE,QAAQe,YAAY,aAG3CrC,KAAMsC,aAAarC,qBAhDrBnD,EAAE,eAAiBwE,QAAQiB,SAAS,YAEpCzF,EAAE,IAAMwE,OAAS,YAAYkB,MAAK,eAE5Bf,YAAc3E,EADT0B,MACeiE,KAAK,eAE7BpF,KAAKM,kBAAkB+E,KAAK,QAAWpB,YAAgB,CAACG,YAAAA,YAAaD,GAH5DhD,WAKPnB,KAAKM,kBAAkBY,OAAS,EAAG,KACjC4D,UAAY9E,KAAKM,kBAAkByE,QACvC/E,KAAKgE,YAAYc,UAAUb,OAAQa,UAAUZ,QA0CnDoB,UAAW,eACLzE,MAAQpB,EAAE,qCAAqCqB,KAAK,cACxDM,QAAQ,CAAC,yBAAyB,SAAUpB,MAC1CA,KAAKuF,WAAW,CACdC,OAAQ,oCACR3E,MAAOA,MACPsC,IAAK,WACHnD,KAAKqB,QAAQ,CAACC,OAAQ,SAAUC,IAAK,YAAaV,MAAOM,KAAKN,MAAOyE,UAAW7F,EAAE0B,KAAKqE,QAAQvE,OAAQ,CAACQ,WAAYhC,EAAE0B,KAAKqE,iBAKnIC,YAAa,SAAU5E,MAAO6E,OAAQC,UACpC7F,IAAIuC,YAAY,CACd,KAAQ,UAAWC,UAAW,UAC7BE,MAAK,SAAUC,OAEV2C,KAAO,CAACvE,MAAOA,MAAO6E,OAAQA,QAGlChG,KAAK4E,KAAK,CAAC,CACTC,WALW,oCAMXC,KAAMY,KACN5C,KAAM,SAAUoD,UAEdhG,aAAa2D,OAAO,CAClB/C,KAAMZ,aAAaiG,MAAMC,YACzBC,MAAOtD,EAAE,GACTuD,KAAMJ,WACLK,MAAK,SAAUC,WACZC,KAAOD,MAAME,UAEjBD,KAAKE,GAAG1G,YAAY2G,MAAM,SAAUC,GAClCA,EAAEC,qBAEEpB,KAAO,OACAvE,aACC6E,iBACGjG,EAAE0G,MAAMxB,KAAK,sBAAsB1D,eACpCxB,EAAE0G,MAAMxB,KAAK,qBAAqB1D,YACrCxB,EAAE0G,MAAMxB,KAAK,kBAAkB1D,OAG1CvB,KAAK4E,KAAK,CAAC,CACTC,WAVW,sCAWXC,KAAMY,KACN5C,KAAM,SAAUiC,QACd/D,QAAQC,IAAI,QAAS8D,aACS,IAAnBA,OAAOgC,SAA6C,GAAlBhC,OAAOgC,UAClDP,MAAMQ,YACkB,IAAbf,eAAoD,IAAjBA,SAASxC,KACrDwC,SAASxC,YAGiB,IAAnBsB,OAAOG,SAChB/E,aAAa6C,MAAM+B,OAAOkC,QAASlC,OAAOG,UAG9CjC,KAAM9C,aAAa+C,gBAIvBsD,MAAMU,WAGVjE,KAAM9C,aAAa+C,gBAGvBD,KAAK9C,aAAa+C,YAEtBiE,gBAAiB,SAAUhG,MAAOiG,SAC5B3F,KAAKd,MAAQ,GAAGK,QAAQC,IAAI,0DAA2DE,MAAOiG,SAClGpH,KAAK4E,KAAK,CAAC,CACTC,WAAY,0CACZC,KAAM,CAAC3D,MAAOA,MAAOiG,QAASA,SAC9BtE,KAAM,SAAUoD,UACdhG,aAAa2D,OAAO,CAClBwC,MAAOjG,IAAIiH,WAAW,SAAU,mBAChCvG,KAAMZ,aAAaiG,MAAMC,YACzBE,KAAMJ,WACLpD,MAAK,SAAU0D,WACZC,KAAOD,MAAME,UAEjBD,KAAKE,GAAG1G,YAAY2G,MAAM,SAAUC,GAClCA,EAAEC,iBACFN,MAAMQ,OACNjH,EAAE0G,MAAMxB,KAAK,QAAQqC,SACrBvH,EAAE0G,MAAMc,YAEVnH,IAAIuC,YAAY,CACd,KAAQ,SAAUC,UAAW,qBAC5BE,MAAK,SAAUC,GAChBhD,EAAE0G,MAAMxB,KAAK,4CAA4CE,KAAKpC,EAAE,OAElEhD,EAAE0G,MAAMxB,KAAK,yBAAyBsC,SAEtCf,MAAMU,WAGVjE,KAAM9C,aAAa+C,cAGvBsE,WAAY,SAAUC,UACpB/F,QAAQ,CAAC,yBAAyB,SAAUpB,MAC1CA,KAAKqB,QAAQ,CAACC,OAAQ,SAAUC,IAAK,cAAe4F,SAAUA,UAAW,QAM7EC,WAAY,SAAU3G,IAAKI,MAAOL,MAC5BW,KAAKd,MAAQ,GAAGK,QAAQC,IAAI,uCAAwCF,IAAKI,MAAOL,MAEpFY,QAAQ,CAAC,yBAAyB,SAAUpB,MAC1CA,KAAKuF,WAAW,CACd1E,MAAOA,MACP2E,OAAQ/F,EAAEgB,KACVD,KAAMA,KACN2C,IAAK,eACCE,EAAIlC,KACRC,QAAQ,CAAC,yBAAyB,SAAUpB,MAC1CA,KAAKqB,QAAQ,CAACC,OAAQ,SAAUC,IAAK,aAAcV,MAAOwC,EAAExC,MAAOL,KAAM6C,EAAE7C,KAAM4G,WAAY3H,EAAE4D,EAAEmC,QAAQvE,OAAQ,CAACQ,WAAYhC,EAAE4D,EAAEmC,oBAS5I6B,iBAAkB,SAAUxG,MAAOyG,KAC7BnG,KAAKd,MAAQ,GAAGK,QAAQC,IAAI,uCAAwCE,MAAOyG,KAC/ElG,QAAQ,CAAC,yBAAyB,SAAUpB,MAC1CA,KAAKqB,QAAQ,CAACC,OAAQ,SAAUC,IAAK,mBAAoBV,MAAOA,OAAQ,CAACY,WAAYhC,EAAE6H,WAQ3FC,YAAa,SAAUtD,OAAQuD,gBACzB3G,MAAQpB,EAAE,UAAYwE,QAAQhD,MAC9BwG,cAAgBhI,EAAE,kBAAoBwE,QAAQhD,MAC9CyG,iBAAmBjI,EAAE,qBAAuBwE,QAAQhD,MACxDG,QAAQ,CAAC,yBAAyB,SAAUpB,MAC1CA,KAAKqB,QAAQ,CAACC,OAAQ,SAAUC,IAAK,yBAA0BV,MAAOA,MAAO4G,cAAeA,cAAeC,iBAAkBA,kBAAmB,CAACjG,WAAYhC,EAAE+H,kBAQnKG,kBAAmB,SAAU1D,OAAQuD,gBAC/B3G,MAAQpB,EAAE,UAAYwE,QAAQhD,MAC9B2G,MAAQ,GACZnI,EAAE,iBAAmBwE,QAAQkB,MAAK,WAChCyC,MAAMA,MAAM1G,QAAU,CACpB2G,OAAQpI,EAAE0B,MAAML,KAAK,eACrBgH,SAAUrI,EAAE0B,MAAMF,UAGtBG,QAAQ,CAAC,yBAAyB,SAAUpB,MAC1CA,KAAKqB,QAAQ,CAACC,OAAQ,SAAUC,IAAK,qBAAsBV,MAAOA,MAAO+G,MAAOG,KAAKC,UAAUJ,QAAS,CAACnG,WAAYhC,EAAE+H,kBAM3HS,iBAAkB,eACZpH,MAAQpB,EAAE,mCAAmCqB,KAAK,cAElDoH,SADOzI,EAAE,4CAA4CwB,MAC3C,IACdxB,EAAE,4EAA4E0F,MAAK,WACjF+C,QAAQ7C,KAAK5F,EAAE0B,MAAMF,UAED,GAAlBiH,QAAQhH,QACZE,QAAQ,CAAC,yBAAyB,SAAUpB,MAC1CA,KAAKqB,QAAQ,CAACC,OAAQ,SAAUC,IAAK,mBAAoBV,MAAOA,MAAOqH,QAASA,SAAU,CAACzG,WAAYhC,EAAE,oDAM7G0I,WAAY,eACNtH,MAAQpB,EAAE,mCAAmCqB,KAAK,cAElDoH,SADOzI,EAAE,4CAA4CwB,MAC3C,IACdxB,EAAE,4EAA4E0F,MAAK,WACjF+C,QAAQ7C,KAAK5F,EAAE0B,MAAMF,UAED,GAAlBiH,QAAQhH,QACZE,QAAQ,CAAC,yBAAyB,SAAUpB,MAC1CA,KAAKqB,QAAQ,CAACC,OAAQ,SAAUC,IAAK,aAAcV,MAAOA,MAAOqH,QAASA,SAAU,CAACzG,WAAYhC,EAAE,6CAGvG2I,YAAa,eACPvH,MAAQpB,EAAE,mCAAmCqB,KAAK,cAClDmB,KAAOxC,EAAE,4CAA4CwB,MACrDiH,QAAU,GACdzI,EAAE,4EAA4E0F,MAAK,WACjF+C,QAAQ7C,KAAK5F,EAAE0B,MAAMF,UAGD,GAAlBiH,QAAQhH,QACZE,QAAQ,CAAC,yBAAyB,SAAUpB,MAC1CA,KAAKqB,QAAQ,CAACC,OAAQ,SAAUC,IAAK,cAAeV,MAAOA,MAAOoB,KAAMA,KAAMiG,QAASA,SAAU,CAACzG,WAAYhC,EAAE,6CAGpH4I,mBAAoB,SAAUC,YAAaC,gBACrC1H,MAAQpB,EAAE,mCAAmCqB,KAAK,cAClD0H,OAAS/I,EAAE,8CAA8CwB,MACzDuH,OAAOtH,OAAS,GAGlBE,QAAQ,CAAC,yBAAyB,SAAUpB,MAC1CA,KAAKqB,QAAQ,CAACC,OAAQ,SAAUC,IAAK,qBAAsBV,MAAOA,MAAO2H,OAAQA,QAAS,CAACF,YAAaA,YAAaC,WAAYA,iBAIvI9D,OAAQ,SAAUpB,MACE,qBAAdA,EAAE+B,KAAK7D,KACc,MAAnB8B,EAAEoB,OAAOC,SACX+D,IAAIC,SAASC,KAAO5I,IAAI6I,YAAY,oCAAqC,CAAC/H,MAAOwC,EAAE+B,KAAKvE,MAAOU,IAAK,QAASsH,IAAK,iBAGpG,qBAAdxF,EAAE+B,KAAK7D,KACc,MAAnB8B,EAAEoB,OAAOC,SACX+D,IAAIC,SAASC,KAAO5I,IAAI6I,YAAY,oCAAqC,CAAC/H,MAAOwC,EAAE+B,KAAKvE,MAAOU,IAAK,QAASsH,IAAK,iBAGpG,eAAdxF,EAAE+B,KAAK7D,MACTH,QAAQ,CAAC,yBAAyB,SAAUpB,MAC1CA,KAAK8I,UAAU,6CAA+CzF,EAAE+B,KAAKtD,SAAW,KAA0B,MAAnBuB,EAAEoB,OAAOC,WAE3E,MAAnBrB,EAAEoB,OAAOC,cACqB,IAArBrB,EAAE0F,QAAQ9F,OAEnB7B,QAAQ,CAAC,yBAAyB,SAAUnB,MAC1CA,KAAK+I,aAAa3F,EAAE+B,KAAKtD,SAAUuB,EAAE+B,KAAKvE,UAI5C4H,IAAIC,SAASC,KAAOF,IAAIC,SAASC,OAIrB,aAAdtF,EAAE+B,KAAK7D,UACJK,yBAEW,oBAAdyB,EAAE+B,KAAK7D,IAA2B,IAChC8B,EAAE0F,QAAQpH,SAAWR,KAAKhB,8BAI9BV,EAAE4D,EAAE0F,QAAQrH,YAAYV,YACpBiI,KAAOC,OAAOD,KAAK5F,EAAEoB,OAAO0E,UAC5BF,KAAK/H,OAAS,MACX,IAAIkI,EAAI,EAAGA,EAAIH,KAAK/H,OAAQkI,IAAK,KAChCC,EAAIhG,EAAEoB,OAAO0E,MAAMF,KAAKG,IACxBE,MAAQ,GACU,UAAlBjG,EAAE0F,QAAQvI,OAEV8I,WADwB,IAAfD,EAAEE,UAA4BF,EAAEE,SACjC,KAEA,MAGZ9J,EAAE4D,EAAE0F,QAAQrH,YAAY8H,OAAO/J,EAAE,YAAYoF,KAAKyE,MAAQD,EAAEI,aAAe,KAAOJ,EAAEK,MAAQ,KAAK5I,KAAK,QAASuI,EAAEM,SAIrG,WAAdtG,EAAE+B,KAAK7D,KAAkC,eAAd8B,EAAE+B,KAAK7D,MACb,MAAnB8B,EAAEoB,OAAOC,SACXjF,EAAE,2BAA6B4D,EAAE+B,KAAK7D,KAAKN,IAAI,MAC/C2I,YAAW,WACTnK,EAAE,2BAA6B4D,EAAE+B,KAAK7D,KAAKN,IAAI,MAC9C,WAEAoH,sBAEW,qBAAdhF,EAAE+B,KAAK7D,MACT9B,EAAE,4DAA4DoF,KAAKxB,EAAEoB,OAAOgC,SAC5EhH,EAAE,2DAA2DoF,KAAKxB,EAAEoB,OAAOoF,QAC3EpK,EAAE,uDAAuD4E,IAAI,UAAYhB,EAAEoB,OAAOgC,QAAU,EAAK,QAAU,QAC3GhH,EAAE,sDAAsD4E,IAAI,UAAYhB,EAAEoB,OAAOoF,OAAS,EAAK,QAAU,QACzGpK,EAAE,6DAA6DqB,KAAK,aAAcuC,EAAE+B,KAAK0E,QAEzE,aAAdzG,EAAE+B,KAAK7D,KACT9B,EAAE,8BAA8BoF,KAAKxB,EAAE+B,KAAKE,WAE5B,eAAdjC,EAAE+B,KAAK7D,KACc,MAAnB8B,EAAEoB,OAAOC,SACX+D,IAAIC,SAASC,KAAO5I,IAAIgK,QAAQ,mBAAoB,IAAM,OAAS1G,EAAE+B,KAAK+B,UAG5D,oBAAd9D,EAAE+B,KAAK7D,UACuB,IAArB8B,EAAEoB,OAAOuF,SAClBtH,MAAM,WAAaW,EAAEoB,OAAOuF,QAAQC,QAAU,iBAAmB5G,EAAEoB,OAAOuF,QAAQE,QAAU,aAG9E,kBAAd7G,EAAE+B,KAAK7D,KAAyC,gBAAd8B,EAAE+B,KAAK7D,MAC3CH,QAAQ,CAAC,yBAAyB,SAAUpB,MAC1CA,KAAK8I,UAAU,6CAA+CzF,EAAE+B,KAAKtD,SAAW,KAA0B,MAAnBuB,EAAEoB,OAAOC,WAE3E,MAAnBrB,EAAEoB,OAAOC,cACqB,IAArBrB,EAAE0F,QAAQ9F,OAEnB7B,QAAQ,CAAC,yBAAyB,SAAUnB,MAC1CA,KAAK+I,kBAA6C,IAAxB3F,EAAEoB,OAAO0F,WAA8B9G,EAAEoB,OAAO0F,WAAWlH,OAASI,EAAEoB,OAAO2F,UAAUT,GAAItG,EAAE+B,KAAKvE,UAEvG,kBAAdwC,EAAE+B,KAAK7D,IAEhBqI,YAAW,WACTnK,EAAE,6CAA+C4D,EAAE+B,KAAKtD,SAAW,MAAMmF,WACxE,KACoB,gBAAd5D,EAAE+B,KAAK7D,KAChB9B,EAAE,6CAA+C4D,EAAE+B,KAAKtD,SAAW,iBAAiB+C,KAAKxB,EAAE+B,KAAKhC,QAItG1C,QAAQC,IAAI0C,GACM,cAAdA,EAAE+B,KAAK7D,KACTzB,IAAIuC,YAAY,CACd,KAAQ,0BAA2BC,UAAW,qBAC7CE,MAAK,SAAUC,GACdrB,QAAQ,CAAC,qBAAsB,mBAAmB,SAAUxB,aAAcyK,WACxEzK,aAAa2D,OAAO,CAClBwC,MAAOtD,EAAE,GACTuD,KAAMqE,UAAUC,OAAO,0CAA2C,CAACT,OAAQxG,EAAEoB,OAAOoF,OAAOU,KAAK,MAAOC,UAAWnH,EAAEoB,OAAOoF,OAAO3I,OAAQuJ,WAAYpH,EAAEoB,OAAOuF,QAAQ9I,OAAQ8I,QAAS3G,EAAEoB,OAAOuF,QAAQO,KAAK,QAC9MG,OAAQ,KACPlI,MAAK,SAAU0D,OAEhBA,MAAMU,gBAIZjE,KAAK9C,aAAa+C,WAEJ,sBAAdS,EAAE+B,KAAK7D,UACqB,IAAnB8B,EAAEoB,OAAO0E,MAAuB,CACzC1J,EAAE,mEAAmEwH,aAC5DmC,EAAI,EAAGA,EAAI/F,EAAEoB,OAAO0E,MAAMjI,OAAQkI,IAAK,KAC1C3G,EAAIhD,EAAE,YAAYqB,KAAK,QAASuC,EAAEoB,OAAO0E,MAAMC,GAAGpH,QAAQ6C,KAAKxB,EAAEoB,OAAO0E,MAAMC,GAAGK,cAA4C,IAA3BpG,EAAEoB,OAAO0E,MAAMC,GAAGM,MAAe,KAAOrG,EAAEoB,OAAO0E,MAAMC,GAAGM,MAAQ,IAAM,KAC9KjK,EAAE,4CAA4C+J,OAAO/G,OAEnDuH,QAAU3G,EAAE0F,QAAQT,iBACD,IAAZ0B,SAA2BA,QAAQ9I,OAAS,GACrDE,QAAQ,CAAC,yBAAyB,SAAUpB,UACrC,IAAIoJ,EAAI,EAAGA,EAAIY,QAAQ9I,OAAQkI,IAClCpJ,KAAK2K,OAAO,CAAClJ,WAAYhC,EAAE,0DAA4DuK,QAAQZ,GAAK,YAAQwB,EAAW,kBAIzHf,OAASxG,EAAE0F,QAAQR,mBACD,IAAXsB,QAA0BA,OAAO3I,OAAS,MAC1CkI,EAAI,EAAGA,EAAIS,OAAO3I,OAAQkI,IACjChI,QAAQ,CAAC,yBAAyB,SAAUpB,MAC1CA,KAAK2K,OAAO,CAAClJ,WAAYhC,EAAE,0DAA4DoK,OAAOT,GAAK,YAAQwB,EAAW,gBAOlIC,iBAAkB,SAAUlB,QACtB9I,OAASpB,EAAE,mCAAmCqB,KAAK,cACvDM,QAAQ,CAAC,yBAAyB,SAAUpB,MAC1CA,KAAKqB,QAAQ,CAACC,OAAQ,SAAUC,IAAK,oBAAqBV,MAAOA,MAAO8I,GAAIA,IAAK"}